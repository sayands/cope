<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>CoPE-VideoLM</title>
        <link rel="stylesheet" href="fonts/avenir-next/stylesheet.css">
        <link rel="stylesheet" href="icons/style.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
        <link rel="stylesheet" href="css/main.css">
        <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
        <style>
        /* ===== Runtime Comparison – scoped styles ===== */
        #runtime-comparison {
          --rc-bg: #f5f7fa;
          --rc-bg-alt: #e8ecf1;
          --rc-border: #d1d5db;
          --rc-text: #1f2937;
          --rc-muted: #6b7280;
          --rc-accent-green: #6567C9;
          --rc-accent-orange: #ff9349;
          --rc-bubble-right: #16a34a;
          --rc-bubble-left: #111827;
          --rc-radius-xl: 1.75rem;
          --rc-shadow-soft: 0 18px 45px rgba(0,0,0,0.12);
          width: 100%;
          margin: 0 auto;
          padding: 0;
        }
        /* Override global styles inside RC */
        #runtime-comparison *, #runtime-comparison *::before, #runtime-comparison *::after {
          box-sizing: border-box;
        }
        #runtime-comparison video {
          width: 100% !important;
          height: 100% !important;
        }
        #runtime-comparison p {
          margin: 0; text-align: left; font-size: inherit; position: static;
        }
        .rc-header {
          display: flex;
          align-items: center;
          justify-content: center;
          margin-bottom: 16px;
        }
        .rc-content {
          display: grid;
          grid-template-columns: 2fr 3fr;
          gap: 24px;
          align-items: center;
          width: 100%;
        }
        @media (max-width: 768px) {
          .rc-content { grid-template-columns: 1fr; gap: 16px; }
          .rc-left-pane { flex-direction: row; flex-wrap: wrap; gap: 8px; justify-content: center; }
          .rc-hero-video-wrapper { max-width: 180px; }
          .rc-note { max-width: 100%; font-size: 0.62rem; padding: 8px 10px; margin-top: 0; }
          .rc-video-caption { font-size: 0.7rem; }
          .rc-carousel-nav { margin-top: 4px; }
          .rc-control-btn { padding: 4px 8px; font-size: 0.68rem; }
        }
        .rc-left-pane {
          display: flex; flex-direction: column; gap: 10px;
          align-items: center; justify-content: flex-start;
        }
        .rc-hero-video-wrapper {
          position: relative; width: 100%; max-width: 360px;
          aspect-ratio: 1; border-radius: 16px; overflow: hidden;
          background: #fff; border: 1px solid rgba(209,213,219,0.5);
          box-shadow: 0 4px 20px rgba(0,0,0,0.06);
        }
        @media (max-width: 768px) { .rc-hero-video-wrapper { max-width: 180px; } }
        .rc-hero-video { width: 100%; height: 100%; display: block; object-fit: cover; }
        .rc-video-caption { text-align: center; font-size: 0.8rem; color: var(--rc-muted); margin-top: 6px; font-weight: 500; }
        .rc-note {
          width: 100%; max-width: 360px; padding: 10px 14px;
          background: #fff; border: 1px solid rgba(209,213,219,0.6);
          border-radius: 10px; font-size: 0.7rem; color: var(--rc-muted); line-height: 1.5;
          box-shadow: 0 2px 8px rgba(0,0,0,0.04); margin-top: 4px;
        }
        .rc-note strong { color: var(--rc-text); font-weight: 600; }
        .rc-right-pane { display: flex; flex-direction: column; gap: 12px; justify-content: flex-start; }
        .rc-phones {
          display: grid; grid-template-columns: repeat(2, minmax(0,1fr));
          gap: 12px; min-height: 0;
        }
        @media (max-width: 600px) {
          .rc-phones { grid-template-columns: repeat(2, minmax(0,1fr)); gap: 8px; }
          .rc-phone-shell { border-radius: 20px; padding: 5px; }
          .rc-phone-notch { height: 8px; top: 5px; width: 35%; }
          .rc-phone-screen { border-radius: 17px; padding: 14px 6px 8px; gap: 4px; }
          .rc-status-row { font-size: 0.5rem; }
          .rc-status-dot { width: 3px; height: 3px; }
          .rc-status-bar-icon { width: 6px; height: 3px; }
          .rc-chat-header { padding: 3px 0; gap: 4px; margin-bottom: 2px; }
          .rc-chat-profile-pic { width: 16px; height: 16px; }
          .rc-chat-contact-name { font-size: 0.55rem; }
          #runtime-comparison .rc-bubble { max-width: 88%; padding: 4px 6px; font-size: 0.52rem; border-radius: 10px; line-height: 1.3; }
          #runtime-comparison .rc-bubble.rc-question { padding-bottom: 10px; }
          #runtime-comparison .rc-read-indicator { font-size: 0.42rem; bottom: 2px; right: 4px; }
          #runtime-comparison .rc-bubble.rc-thought-time { font-size: 0.46rem; padding: 1px 4px; }
          #runtime-comparison .rc-meta-label { font-size: 0.48rem; }
          #runtime-comparison .rc-typing-dot { width: 3px; height: 3px; }
          .rc-chat-window { gap: 3px; padding-right: 2px; }
          .rc-chat-window::-webkit-scrollbar { width: 2px; }
        }
        .rc-phone { display: flex; justify-content: center; align-items: flex-start; min-height: 0; }
        .rc-phone-shell {
          position: relative; width: 100%; max-width: 280px;
          aspect-ratio: 9 / 18; border-radius: 34px; padding: 10px;
          background: linear-gradient(145deg, #2a2a2e, #1a1a1e);
          border: 1px solid rgba(60,60,68,0.7);
          box-shadow: 0 8px 30px rgba(0,0,0,0.25), 0 2px 8px rgba(0,0,0,0.15);
          overflow: hidden;
          display: flex; flex-direction: column;
        }
        @media (max-width: 500px) { .rc-phone-shell { max-width: 100%; border-radius: 18px; padding: 4px; } }
        .rc-phone-notch {
          position: absolute; top: 8px; left: 50%; transform: translateX(-50%);
          width: 40%; height: 12px; background: #1c1c1e;
          border-radius: 999px; box-shadow: 0 0 0 1px #0a0a0a;
          z-index: 2;
        }
        .rc-phone-screen {
          position: relative; width: 100%; height: 100%; border-radius: 26px;
          background: #000000; padding: 24px 14px 16px;
          display: flex; flex-direction: column; gap: 10px;
          overflow: hidden;
          min-height: 0;
          flex: 1 1 0;
        }
        .rc-status-row { display: flex; justify-content: space-between; align-items: center; font-size: 0.65rem; color: #8e8e93; flex-shrink: 0; }
        .rc-status-left { display: flex; align-items: center; gap: 5px; }
        .rc-status-dot { width: 5px; height: 5px; border-radius: 999px; background: var(--rc-accent-green); box-shadow: 0 0 10px rgba(101,103,201,0.6); }
        .rc-status-right { display: flex; align-items: center; gap: 4px; opacity: 0.8; }
        .rc-status-bar-icon { width: 9px; height: 5px; border-radius: 999px; border: 1px solid #8e8e93; }
        .rc-chat-header { display: flex; align-items: center; justify-content: center; gap: 8px; padding: 6px 0; border-bottom: 1px solid rgba(56,56,60,0.6); margin-bottom: 4px; flex-shrink: 0; }
        .rc-chat-profile-pic { width: 26px; height: 26px; border-radius: 50%; border: 1.5px solid rgba(56,56,60,0.6); display: flex; align-items: center; justify-content: center; flex-shrink: 0; overflow: hidden; background: #1c1c1e; }
        .rc-chat-profile-pic img { width: 100%; height: 100%; object-fit: cover; }
        .rc-chat-contact-name { font-size: 0.76rem; font-weight: 600; color: #e5e5ea; letter-spacing: 0.01em; }
        .rc-chat-window {
          flex: 1 1 0; display: flex; flex-direction: column; gap: 6px;
          justify-content: flex-start; overflow-y: auto; overflow-x: hidden;
          padding-right: 4px; min-height: 0;
          max-height: 100%;
        }
        .rc-chat-window::-webkit-scrollbar { width: 3px; }
        .rc-chat-window::-webkit-scrollbar-track { background: rgba(40,40,44,0.5); border-radius: 999px; }
        .rc-chat-window::-webkit-scrollbar-thumb { background: rgba(100,100,108,0.4); border-radius: 999px; }
        #runtime-comparison .rc-message-row { display: flex; width: 100%; margin-top: 4px; flex-shrink: 0; }
        #runtime-comparison .rc-message-row.left { justify-content: flex-start; }
        #runtime-comparison .rc-message-row.right { justify-content: flex-end; }
        #runtime-comparison .rc-bubble {
          max-width: 80%; padding: 9px 11px; font-size: 0.76rem;
          border-radius: 16px; line-height: 1.4; word-wrap: break-word;
          overflow-wrap: break-word; word-break: break-word;
          opacity: 0; transform: translateY(4px);
          transition: opacity 0.25s ease-out, transform 0.25s ease-out;
        }
        #runtime-comparison .rc-bubble.visible { opacity: 1; transform: translateY(0); }
        #runtime-comparison .rc-bubble.rc-question {
          background: var(--rc-bubble-right); color: #fff;
          border-bottom-right-radius: 4px; font-weight: 500;
          box-shadow: 0 6px 14px rgba(22,163,74,0.24);
          position: relative; padding-bottom: 16px;
        }
        #runtime-comparison .rc-read-indicator {
          position: absolute; bottom: 3px; right: 6px; font-size: 0.58rem;
          color: rgba(255,255,255,0.85); font-weight: 600; opacity: 0;
          transition: opacity 0.3s ease-out; visibility: hidden;
        }
        #runtime-comparison .rc-read-indicator.visible { opacity: 1; visibility: visible; }
        #runtime-comparison .rc-bubble.rc-answer {
          background: #2c2c2e; color: #e5e5ea;
          border-bottom-left-radius: 4px; border: 1px solid rgba(56,56,60,0.9);
        }
        #rc-phone-1 .rc-bubble.rc-answer { background: #C00000; border: 1px solid #A00000; color: #fff; }
        #rc-phone-2 .rc-bubble.rc-answer { background: #6567C9; border: 1px solid #5254B3; color: #fff; }
        #runtime-comparison .rc-bubble.rc-meta {
          background: #1c1c1e; color: #8e8e93;
          border-bottom-left-radius: 4px; border: 1px solid rgba(56,56,60,0.9);
          display: inline-flex; align-items: center; gap: 6px;
        }
        #runtime-comparison .rc-meta-label { font-size: 0.65rem; font-weight: 500; color: #8e8e93; }
        #runtime-comparison .rc-bubble.rc-thought-time {
          background: transparent; border: none; color: #8e8e93;
          font-size: 0.62rem; padding: 2px 6px; font-style: italic;
        }
        #runtime-comparison .rc-typing {
          display: inline-flex; align-items: center; gap: 3px;
          margin-left: 2px; opacity: 0; transition: opacity 0.2s ease-out;
        }
        #runtime-comparison .rc-typing-dot {
          width: 4px; height: 4px; border-radius: 999px;
          background: #8e8e93; opacity: 0.25;
          animation: rc-typing-bounce 1.1s infinite ease-in-out;
        }
        #runtime-comparison .rc-typing-dot:nth-child(2) { animation-delay: 0.15s; }
        #runtime-comparison .rc-typing-dot:nth-child(3) { animation-delay: 0.3s; }
        @keyframes rc-typing-bounce {
          0%, 80%, 100% { transform: translateY(0); opacity: 0.2; }
          40% { transform: translateY(-2px); opacity: 0.9; }
        }
        #runtime-comparison .rc-typing.active { opacity: 1; }
        .rc-phone-shell.is-orange .rc-meta-label { color: #c2410c; }
        .rc-phone-shell.is-orange .rc-bubble.rc-thought-time { color: #c2410c; }

        /* Carousel */
        .rc-carousel-nav { display: flex; align-items: center; justify-content: center; gap: 12px; margin-top: 10px; }
        .rc-carousel-indicator { font-size: 0.78rem; color: var(--rc-muted); font-weight: 500; }
        .rc-carousel-dots { display: flex; gap: 6px; align-items: center; }
        .rc-carousel-dot { width: 7px; height: 7px; border-radius: 50%; background: rgba(156,163,175,0.3); transition: all 0.3s; cursor: pointer; }
        .rc-carousel-dot.active { background: var(--rc-accent-green); width: 20px; border-radius: 4px; }
        .rc-carousel-dot:hover:not(.active) { background: rgba(156,163,175,0.6); }

        /* Control buttons */
        .rc-control-panel { display: flex; gap: 6px; align-items: center; flex-wrap: wrap; justify-content: center; }
        .rc-control-btn {
          padding: 6px 12px; background: #fff;
          border: 1px solid rgba(209,213,219,0.8); border-radius: 6px;
          color: var(--rc-text); font-family: inherit;
          font-size: 0.76rem; font-weight: 600; cursor: pointer;
          transition: all 0.2s; box-shadow: 0 1px 3px rgba(0,0,0,0.04);
        }
        .rc-control-btn:hover:not(:disabled) {
          background: #f8f9fb; border-color: rgba(156,163,175,1);
          transform: translateY(-1px); box-shadow: 0 3px 8px rgba(0,0,0,0.08);
        }
        .rc-control-btn:active { transform: translateY(0); }
        .rc-control-btn.rc-start { background: rgba(101,103,201,0.1); border-color: rgba(101,103,201,0.4); color: #6567C9; }
        .rc-control-btn.rc-start:hover:not(:disabled) { background: rgba(101,103,201,0.2); border-color: rgba(101,103,201,0.6); }
        .rc-control-btn.rc-pause { background: rgba(251,146,60,0.1); border-color: rgba(251,146,60,0.4); color: #ea580c; }
        .rc-control-btn.rc-pause:hover:not(:disabled) { background: rgba(251,146,60,0.2); border-color: rgba(251,146,60,0.6); }
        .rc-control-btn.rc-reset { background: rgba(239,68,68,0.1); border-color: rgba(239,68,68,0.4); color: #dc2626; }
        .rc-control-btn.rc-reset:hover:not(:disabled) { background: rgba(239,68,68,0.2); border-color: rgba(239,68,68,0.6); }
        .rc-control-btn.rc-nav { background: rgba(100,116,139,0.1); border-color: rgba(100,116,139,0.4); color: #475569; }
        .rc-control-btn.rc-nav:hover:not(:disabled) { background: rgba(100,116,139,0.2); border-color: rgba(100,116,139,0.6); }
        .rc-control-btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none !important; }

        /* Progress panel */
        .rc-progress-panel {
          display: none; width: 100%; padding: 12px 14px 8px;
          background: #fff; border: 1px solid rgba(209,213,219,0.6);
          border-radius: 12px; box-shadow: 0 4px 16px rgba(0,0,0,0.05);
          flex-shrink: 0; margin-top: 4px;
        }
        .rc-progress-panel.visible { display: block; animation: rc-progressFadeIn 0.4s ease forwards; }
        @keyframes rc-progressFadeIn {
          from { opacity: 0; transform: translateY(6px); }
          to { opacity: 1; transform: translateY(0); }
        }
        .rc-progress-header { font-size: 0.7rem; font-weight: 700; color: var(--rc-muted); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 10px; }
        .rc-progress-track-wrapper { display: flex; flex-direction: column; gap: 10px; }
        .rc-progress-row { display: grid; grid-template-columns: 90px 1fr 48px 50px; gap: 8px; align-items: center; }
        .rc-progress-label { font-size: 0.7rem; font-weight: 600; white-space: nowrap; }
        .rc-progress-label.rc-llava { color: #dc2626; }
        .rc-progress-label.rc-cope { color: #6567C9; }
        .rc-progress-track { height: 12px; min-width: 0; background: rgba(226,232,240,1); border-radius: 999px; overflow: hidden; border: 1px solid rgba(203,213,225,0.7); }
        .rc-progress-fill { height: 100%; width: 0%; border-radius: 999px; transition: width 0.15s linear; position: relative; }
        .rc-progress-fill.rc-llava { background: linear-gradient(90deg, #C00000, #f87171); box-shadow: 0 0 8px rgba(192,0,0,0.45); }
        .rc-progress-fill.rc-cope { background: linear-gradient(90deg, #6567C9, #9b9dea); box-shadow: 0 0 8px rgba(101,103,201,0.45); }
        .rc-progress-fill.complete { box-shadow: none; }
        .rc-progress-time { font-size: 0.7rem; font-weight: 600; color: var(--rc-muted); text-align: right; font-variant-numeric: tabular-nums; }
        .rc-progress-badge { font-size: 0.62rem; font-weight: 700; text-align: center; padding: 2px 5px; border-radius: 5px; opacity: 0; transition: opacity 0.35s ease; white-space: nowrap; }
        .rc-progress-badge.winner { background: rgba(101,103,201,0.15); border: 1px solid rgba(101,103,201,0.4); color: #6567C9; opacity: 1; font-weight: 800; }
        .rc-progress-badge.slower { background: rgba(192,0,0,0.1); border: 1px solid rgba(192,0,0,0.3); color: #C00000; opacity: 1; font-weight: 500; }
        .rc-progress-speedup { margin-top: 10px; font-size: 0.76rem; font-weight: 600; text-align: center; color: #6567C9; min-height: 1.2em; opacity: 0; transition: opacity 0.4s ease; }
        .rc-progress-speedup.visible { opacity: 1; }

        /* Summary metrics table */
        .rc-progress-summary {
          margin-top: 0; padding-top: 0; max-height: 0; overflow: hidden;
          border-top: none; opacity: 0;
          transition: opacity 0.4s ease, max-height 0.35s ease, margin-top 0.3s ease, padding-top 0.3s ease;
        }
        .rc-progress-summary.visible {
          margin-top: 10px; padding-top: 10px; max-height: 200px; overflow: visible;
          border-top: 1px solid rgba(209,213,219,0.5); opacity: 1;
        }
        .rc-summary-grid {
          display: grid; grid-template-columns: 70px 1fr 1fr; gap: 4px 10px;
          font-size: 0.68rem; align-items: center;
        }
        .rc-summary-header { font-weight: 700; text-align: center; font-size: 0.62rem; letter-spacing: 0.02em; }
        .rc-summary-header.rc-llava { color: #dc2626; }
        .rc-summary-header.rc-cope { color: #6567C9; }
        .rc-summary-label { font-weight: 600; color: var(--rc-muted); font-size: 0.66rem; text-align: center; }
        .rc-summary-value { text-align: center; font-weight: 600; font-variant-numeric: tabular-nums; padding: 2px 0; }
        .rc-summary-value.rc-llava { color: #dc2626; }
        .rc-summary-value.rc-cope { color: #6567C9; }

        @media (max-width: 600px) {
          .rc-progress-row { grid-template-columns: 56px 1fr 34px 38px; gap: 4px; }
          .rc-progress-label, .rc-progress-time { font-size: 0.58rem; }
          .rc-progress-panel { padding: 8px 8px 6px; border-radius: 8px; }
          .rc-progress-header { font-size: 0.6rem; margin-bottom: 6px; }
          .rc-progress-track { height: 8px; }
          .rc-progress-badge { font-size: 0.52rem; padding: 1px 3px; }
          .rc-progress-speedup { font-size: 0.65rem; margin-top: 6px; }
          .rc-summary-grid { grid-template-columns: 55px 1fr 1fr; gap: 3px 6px; font-size: 0.58rem; }
          .rc-summary-header { font-size: 0.54rem; }
          .rc-summary-label { font-size: 0.56rem; }
        }
        </style>
    </head>
    <body>
        <div id="main">
            <div id="title" class="x-gradient-font">
                <span style="font-size: 54px;">CoPE-VideoLM</span><br>
                <span style="font-size: 28px;">Codec Primitives For Efficient Video Language Models</span>
            </div>

            <div id="authors">
                <!-- TODO: Update authors -->
                <div><a class="link" href="#" target="_blank">Sayan Deb Sarkar</a><sup> 1<sup>*</sup></sup></div>
                <div><a class="link" href="#" target="_blank">Rémi Pautrat</a><sup> 2 </sup></div>
                <div><a class="link" href="#" target="_blank">Ondrej Miksik</a><sup> 2 </sup></div>
                <div><a class="link" href="#" target="_blank">Marc Pollefeys</a><sup> 2,3 </sup></div>
                <div><a class="link" href="#" target="_blank">Iro Armeni</a><sup> 1 </sup></div>
                <div><a class="link" href="#" target="_blank">Mahdi Rad</a><sup> 2<sup>†</sup></sup></div>
                <div><a class="link" href="#" target="_blank">Mihai Dusmanu</a><sup> 2<sup>†</sup></sup></div>
            </div>

            <div id="institution">
                <!-- TODO: Update institutions -->
                <div><sup>1 </sup>Stanford University</div>
                <div><sup>2 </sup>Microsoft Spatial AI Lab</div>
                <div><sup>3 </sup>ETH Zurich</div>
            </div>

            <div style="text-align: center; font-size: 13px; color: rgb(96, 96, 96); margin-top: 4px;">
                <span><sup>*</sup> Part of work done during an internship at Microsoft</span>
                &nbsp;&nbsp;
                <span><sup>†</sup> Equal supervision </span>
            </div>

            <!-- Institution Logos -->
            <div id="logos" style="display: flex; align-items: center; justify-content: center; gap: 40px; margin: 20px 0 8px 0; flex-wrap: wrap;">
                <a href="#" target="_blank"><img src="assets/logos/stanford.png" alt="Stanford University" style="height: 50px; object-fit: contain;"></a>
                <a href="#" target="_blank"><img src="assets/logos/gradient_spaces.png" alt="Microsoft" style="height: 50px; object-fit: contain;"></a>
                <a href="#" target="_blank"><img src="assets/logos/ethz.png" alt="ETH Zurich" style="height: 50px; object-fit: contain;"></a>
                <a href="#" target="_blank"><img src="assets/logos/microsoft.png" alt="Microsoft" style="height: 50px; object-fit: contain;"></a>
            </div>

            <div id="links">
                <div><a id="paper" href="#" target="_blank">Paper</a></div>
                <div><a id="arxiv" href="#" target="_blank"><i class="ai ai-arxiv"></i> arXiv</a></div>
                <div><a id="code" href="#" target="_blank">Code</a></div>
            </div>

            <!-- Teaser: placeholder for teaser image/video -->
            <!-- <div id="teaser">
                <div style="width: 100%;"><img src="assets/images/teaser.png" alt="CoPE-VideoLM Teaser" style="width: 100%;"></div>
            </div> -->

            <!-- TL;DR -->
            <!-- <div class="x-center-text" style="font-size: 20px; font-weight: 500; color: #3f3f3f;">
                <b>TL;DR:</b> <i>[One-line summary to be added]</i>
            </div> -->

            <div id="abstract" class="x-gradient-block">
                Video Language Models (VideoLMs) empower AI systems to understand temporal dynamics in videos. To fit to the maximum context 
                window constraint, current methods use keyframe sampling which can miss both macro-level events and micro-level details due to 
                the sparse temporal coverage. Furthermore, processing full images and their tokens for each frame incurs substantial 
                computational overhead. To address these limitations, we propose to leverage video codec primitives (specifically motion 
                vectors and residuals) which natively encode video redundancy and sparsity without requiring expensive full-image encoding for 
                most frames. To this end, we introduce lightweight transformer-based encoders that aggregate codec primitives and align their 
                representations with image encoder embeddings through a pre-training strategy  that accelerates convergence during end-to-end 
                fine-tuning. Our approach reduces the time-to-first-token by up to 86% and token usage by up to 93% compared to standard 
                VideoLMs. Moreover, by varying the keyframe and codec primitive densities we are able to maintain or exceed performance on 
                15 diverse video understanding benchmarks spanning general question answering, temporal reasoning, long-form understanding, 
                and spatial scene understanding.
            </div>


            <!-- ==================== Method ==================== -->
            <div class="x-section-title"><div class="x-gradient-font">Method</div></div>
            <p>
                [Method description to be added]
            </p>
            <!-- <p>
                <img class="pipeline-img" src="assets/images/pipeline.png" alt="Overview of the method" style="width: 100%;">
            </p> -->


            <!-- ==================== Benchmark Performance ==================== -->
            <div class="x-section-title"><div class="x-gradient-font">Benchmark Performance</div></div>

            <!-- Benchmark selector buttons -->
            <div class="benchmark-selector">
                <div class="benchmark-row">
                    <span class="benchmark-category-label" style="color: #43A047;">General Video QA</span>
                    <div class="benchmark-btn-group">
                        <button class="benchmark-btn green is-active" data-benchmark="perceptiontest">PerceptionTest</button>
                        <button class="benchmark-btn green" data-benchmark="nextqa">NExT-QA</button>
                        <button class="benchmark-btn green" data-benchmark="actnetqa">ActNet-QA</button>
                        <button class="benchmark-btn green" data-benchmark="videomme">VideoMME</button>
                        <button class="benchmark-btn green" data-benchmark="egoschema">EgoSchema</button>
                    </div>
                </div>
                <div class="benchmark-row">
                    <span class="benchmark-category-label" style="color: #F57C00;">Temporal &amp; Motion Understanding</span>
                    <div class="benchmark-btn-group">
                        <button class="benchmark-btn orange" data-benchmark="tempcompass">TempCompass</button>
                        <button class="benchmark-btn orange" data-benchmark="tomato">Tomato</button>
                        <button class="benchmark-btn orange" data-benchmark="cvrres">CVRR-ES</button>
                        <button class="benchmark-btn orange" data-benchmark="mvbench">MVBench</button>
                    </div>
                </div>
                <div class="benchmark-row">
                    <span class="benchmark-category-label" style="color: #7E57C2;">Instruction Following &amp; Long Form Reasoning</span>
                    <div class="benchmark-btn-group">
                        <button class="benchmark-btn purple" data-benchmark="videott">Video-TT</button>
                        <button class="benchmark-btn purple" data-benchmark="videommmu">Video-MMMU</button>
                        <button class="benchmark-btn purple" data-benchmark="lvbench">LVBench</button>
                        <button class="benchmark-btn purple" data-benchmark="longvideobench">LongVideoBench</button>
                    </div>
                </div>
            </div>

            <!-- Chart canvas -->
            <div class="benchmark-chart-container">
                <canvas id="benchmarkChart"></canvas>
            </div>


            <!-- ==================== Runtime Comparison ==================== -->
            <div class="x-section-title"><div class="x-gradient-font">Interactive Runtime Comparison</div></div>
            <div id="runtime-comparison">
              <!-- Header controls -->
              <div class="rc-header">
                <div class="rc-control-panel" id="rcControlPanel">
                  <button class="rc-control-btn rc-nav" id="rcPrevBtn">&#8592; Prev</button>
                  <button class="rc-control-btn rc-start" id="rcStartBtn">&#9654; Start</button>
                  <button class="rc-control-btn rc-pause" id="rcPauseBtn" disabled>&#9208; Pause</button>
                  <button class="rc-control-btn rc-reset" id="rcResetBtn">&#8635; Reset</button>
                  <button class="rc-control-btn rc-nav" id="rcNextBtn">Next &#8594;</button>
                </div>
              </div>

              <div class="rc-content">
                <!-- LEFT PANE -->
                <section class="rc-left-pane">
                  <div class="rc-hero-video-wrapper">
                    <video class="rc-hero-video" id="rcHeroVideo" autoplay muted loop playsinline>
                      <source src="runtime_comparison/assets/video_example1.mp4" type="video/mp4" id="rcVideoSource" />
                      Your browser does not support the video tag.
                    </video>
                  </div>
                  <div class="rc-video-caption" id="rcVideoCaption">Example Video</div>

                  <!-- Carousel Navigation -->
                  <div class="rc-carousel-nav">
                    <div class="rc-carousel-dots" id="rcCarouselDots"></div>
                    <span class="rc-carousel-indicator" id="rcCarouselIndicator">1 / 1</span>
                  </div>


                </section>

                <!-- RIGHT PANE: PHONES -->
                <section class="rc-right-pane">
                  <div class="rc-phones">
                    <!-- PHONE 1 -->
                    <div class="rc-phone">
                      <div class="rc-phone-shell" id="rc-phone-1">
                        <div class="rc-phone-notch"></div>
                        <div class="rc-phone-screen">
                          <div class="rc-status-row">
                            <div class="rc-status-left">
                              <span class="rc-status-dot"></span>
                              <span>Chat</span>
                            </div>
                            <div class="rc-status-right">
                              <span>9:41</span>
                              <span class="rc-status-bar-icon"></span>
                            </div>
                          </div>

                          <div class="rc-chat-header">
                            <div class="rc-chat-profile-pic">
                              <img src="runtime_comparison/assets/llava_logo.png" alt="LLaVA-Video" />
                            </div>
                            <div class="rc-chat-contact-name">LLaVA-Video</div>
                          </div>

                          <div class="rc-chat-window" data-role="rc-chat-window"></div>
                        </div>
                      </div>
                    </div>

                    <!-- PHONE 2 -->
                    <div class="rc-phone">
                      <div class="rc-phone-shell" id="rc-phone-2">
                        <div class="rc-phone-notch"></div>
                        <div class="rc-phone-screen">
                          <div class="rc-status-row">
                            <div class="rc-status-left">
                              <span class="rc-status-dot"></span>
                              <span>Chat</span>
                            </div>
                            <div class="rc-status-right">
                              <span>9:41</span>
                              <span class="rc-status-bar-icon"></span>
                            </div>
                          </div>

                          <div class="rc-chat-header">
                            <div class="rc-chat-profile-pic">
                              <img src="runtime_comparison/assets/cope_logo.png" alt="CoPE-VideoLM" />
                            </div>
                            <div class="rc-chat-contact-name">CoPE-VideoLM</div>
                          </div>

                          <div class="rc-chat-window" data-role="rc-chat-window"></div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Chat Progress Bars -->
                  <div class="rc-progress-panel" id="rcProgressPanel">
                    <div class="rc-progress-header">Chat Completion Progress</div>
                    <div class="rc-progress-track-wrapper">
                      <!-- LLaVA-Video bar -->
                      <div class="rc-progress-row" id="rcProgressRow1">
                        <span class="rc-progress-label rc-llava">LLaVA-Video</span>
                        <div class="rc-progress-track">
                          <div class="rc-progress-fill rc-llava" id="rcProgressFill1"></div>
                        </div>
                        <span class="rc-progress-time" id="rcProgressTime1">0.00s</span>
                        <span class="rc-progress-badge" id="rcProgressBadge1"></span>
                      </div>
                      <!-- CoPE-VideoLM bar -->
                      <div class="rc-progress-row" id="rcProgressRow2">
                        <span class="rc-progress-label rc-cope">CoPE-VideoLM</span>
                        <div class="rc-progress-track">
                          <div class="rc-progress-fill rc-cope" id="rcProgressFill2"></div>
                        </div>
                        <span class="rc-progress-time" id="rcProgressTime2">0.00s</span>
                        <span class="rc-progress-badge" id="rcProgressBadge2"></span>
                      </div>
                    </div>
                    <div class="rc-progress-speedup" id="rcProgressSpeedup"></div>
                    <div class="rc-progress-summary" id="rcProgressSummary"></div>
                  </div>
                </section>
              </div>
            </div>


            <!-- ==================== Citation ==================== -->
            <div class="x-section-title"><div class="x-gradient-font">Citation</div></div>
            <p>
                If you find our work useful, please consider citing:
            </p>
            <p class="bibtex x-gradient-block">
@article{cope_videolm,
    title={CoPE-VideoLM: Codec Primitives For Efficient Video Language Models},
    author={TODO},
    year={2026},
    eprint={TODO},
    archivePrefix={arXiv},
    primaryClass={cs.CV}
}</p>


            <!-- ==================== Acknowledgements ==================== -->
            <div class="x-section-title"><div class="x-gradient-font">Acknowledgements</div></div>
            <p>
                <i>
                    [Acknowledgements to be added]<br>
                    Website template inspired by <a href="https://sayands.github.io/guideflow3d/" style="color: #6567C9;" target="_blank">GuideFlow3D</a>.
                </i>
            </p>
        </div>

        <!-- Bottom Bar -->
        <div id="bottombar">
            <div class="row">
                <div><span>CoPE-VideoLM</span>: Video Instruction Tuning with Synthetic Data</div>
                <div style="display: flex; flex-direction: row; gap: 8px;">
                    <a href="mailto:TODO@email.com">Contact</a>
                </div>
            </div>
        </div>

        <!-- ==================== Benchmark Chart Script ==================== -->
        <script>
        document.addEventListener('DOMContentLoaded', function() {
          var benchmarkData = {
            perceptiontest: {
              label: 'PerceptionTest',
              models: {
                'Video-LaViT': 47.9,
                'VILA-40B': 54.0,
                'IXC-2.5-7B': 34.4,
                'LLaVA-OV-7B': 57.1,
                'Apollo-7B': 57.3,
                'Oryx-7B': 68.6,
                'LLaVA-Video-7B': 67.9,
                'CoPE-VideoLM-7B (Ours)': 70.5
              }
            },
            nextqa: {
              label: 'NExT-QA',
              models: {
                'VILA-40B': 67.9,
                'LongVA-7B': 68.3,
                'IXC-2.5-7B': 71.0,
                'LLaVA-OV-7B': 79.4,
                'Oryx-7B': 81.9,
                'LLaVA-Video-7B': 83.2,
                'CoPE-VideoLM-7B (Ours)': 81.8
              }
            },
            actnetqa: {
              label: 'ActNet-QA',
              minX: 40,
              models: {
                'Video-LaViT': 50.1,
                'EMA-7B': 52.1,
                'LongVA-7B': 50.0,
                'IXC-2.5-7B': 52.8,
                'LLaVA-OV-7B': 56.6,
                'LLaVA-Video-7B': 56.5,
                'VILA-40B': 58.0,
                'CoPE-VideoLM-7B (Ours)': 58.8
              }
            },
            videomme: {
              label: 'VideoMME',
              grouped: true,
              models: {
                'LongVA-7B': { wo: 52.6, w: 54.3 },
                'EMA-7B': { wo: 53.4, w: 58.4 },
                'IXC-2.5-7B': { wo: 55.8, w: 58.8 },
                'LLaVA-OV-7B': { wo: 58.2, w: 61.5 },
                'Oryx-7B': { wo: 58.3, w: 62.6 },
                'VILA-40B': { wo: 60.1, w: 61.1 },
                'Apollo-7B': { wo: 61.3, w: 63.3 },
                'CoPE-VideoLM-7B (Ours)': { wo: 61.7, w: 67.8 },
                'LLaVA-Video-7B': { wo: 63.3, w: 69.7 }
              }
            },
            egoschema: {
              label: 'EgoSchema',
              models: {
                'Video-LaViT': 37.3,
                'IXC-2.5-7B': 37.3,
                'LLaVA-OV-7B': 50.1,
                'LongVA-7B': 56.3,
                'VILA-40B': 58.0,
                'LLaVA-Video-7B': 57.3
              }
            },
            tempcompass: {
              label: 'TempCompass',
              models: {
                'VideoChat2-7B': 45.5,
                'LongVA-7B': 56.9,
                'LLaVA-OV-7B': 64.8,
                'Apollo-7B': 64.9,
                'InternVL2-8B': 65.3,
                'LLaVA-Video-7B': 66.6,
                'IXC-2.5-7B': 67.1,
                'CoPE-VideoLM-7B (Ours)': 68.4
              }
            },
            tomato: {
              label: 'Tomato',
              models: {
                'VideoLLaMA2-7B': 18.5,
                'InternVL2-8B': 21.7,
                'LLaVA-Video-7B': 24.9,
                'LLaVA-OV-7B': 25.5,
                'VideoCCAM-9B': 27.0,
                'InternVideo2-8B': 26.4,
                'LLaVA-Video-7B-Video-Only': 23.9,
                'CoPE-VideoLM-7B (Ours)': 28.3
              }
            },
            cvrres: { 
              label: 'CVRR-ES',
              models: {
                'VideoLLaMA2-7B': 21.6,
                'VideoChatGPT': 25.0,
                'VideoChat': 25.8,
                'TimeChat': 35.9,
                'LLaVA-OV-7B': 42.6,
                'LLaVA-Video-7B': 43.6,
                'CoPE-VideoLM-7B (Ours)': 49.1
              }
            },
            mvbench: {
              label: 'MVBench',
              models: {
                'VideoChat2-7B': 51.1,
                'VideoLLaMA2-7B': 54.6,
                'LLaVA-OV-7B': 56.7,
                'LLaVA-Video-7B': 58.6,
                'CoPE-VideoLM-7B (Ours)': 61.6,
                'VideoCCAM-9B': 64.6,
                'InternVL2-8B': 65.8,
                'IXC-2.5-7B': 69.1
              }
            },
            videott: {
              label: 'Video-TT',
              models: {
                'Qwen2.5-VL-7B': 39.9,
                'LLaVA-Video-7B': 41.8,
                'LLaVA-OV-7B': 44.0,
                'CoPE-VideoLM-7B (Ours)': 44.3,
                'Ola-7B': 45.5,
                'InternVL-2.5-8B': 44.7,
                'Oryx-1.5-7B': 44.8
              }
            },
            videommmu: {
              label: 'Video-MMMU',
              models: {
                'LongVA-7B': 23.9,
                'Llama-3.2-11B': 30.00,
                'LLaVA-OV-7B': 33.9,
                'VILA1.5-40B': 34.0,
                'LLaVA-Video-7B': 36.1,
                'InternVL2-8B': 37.4,
                'CoPE-VideoLM-7B (Ours)': 37.9
              }
            },
            lvbench: {
              label: 'LVBench',
              models: {
                'PLLaVA-34B': 26.1,
                'Kangaroo-8B': 39.4,
                'LLaVA-OV-7B': 38.4,
                'TimeMarker-7B': 41.3,
                'mPLUG-Owl3-7B': 43.5,
                'LLaVA-Video-7B': 44.2,
                'CoPE-VideoLM-7B (Ours)': 46.4
              }
            },
            longvideobench: {
              label: 'LongVideoBench',
              models: {
                'EMA-7B': 47.0,
                'mPLUG-Owl3-7B': 52.1,
                'PLLaVA-34B': 53.2,
                'InternVL2-8B': 54.6,
                'Kangaroo-8B': 54.8,
                'TimeMarker-7B': 56.3,
                'LLaVA-OV-7B': 56.5,
                'CoPE-VideoLM-7B (Ours)': 56.9,
                'LLaVA-Video-7B': 58.2
              }
            }
          };

          function getBarColor(modelName) {
            if (modelName.includes('(Ours)')) return '#6567C9';
            return '#CBD5E1';
          }

          function getBorderColor(modelName) {
            if (modelName.includes('(Ours)')) return '#5254B3';
            return '#A0AEC0';
          }

          var ctx = document.getElementById('benchmarkChart');
          if (!ctx) return;

          var chart = null;

          /* Plugin: custom y-axis labels with italic "(Ours)" */
          var customYLabelsPlugin = {
            id: 'customYLabels',
            afterDraw: function(chartInst) {
              var yAxis = chartInst.scales.y;
              var c = chartInst.ctx;
              yAxis.ticks.forEach(function(tick, index) {
                var label = typeof tick.label === 'string' ? tick.label : String(tick.label);
                var y = yAxis.getPixelForTick(index);
                var x = yAxis.right - 10;
                c.save();
                c.textAlign = 'right';
                c.textBaseline = 'middle';
                if (label.indexOf('(Ours)') !== -1) {
                  c.font = 'bold italic 12px "Avenir Next Cyr", "Inter", sans-serif';
                  c.fillStyle = '#6567C9';
                  c.fillText(label, x, y);
                } else {
                  c.font = '12px "Avenir Next Cyr", "Inter", sans-serif';
                  c.fillStyle = '#374151';
                  c.fillText(label, x, y);
                }
                c.restore();
              });
            }
          };

          /* Plugin: value labels at end of bars */
          var valueLabelPlugin = {
            id: 'valueLabels',
            afterDatasetsDraw: function(chartInst) {
              var c = chartInst.ctx;
              var isGrouped = chartInst.data.datasets.length > 1;
              chartInst.data.datasets.forEach(function(dataset, i) {
                var meta = chartInst.getDatasetMeta(i);
                meta.data.forEach(function(bar, index) {
                  var value = dataset.data[index];
                  if (value === null || value === undefined) return;
                  var label = chartInst.data.labels[index];
                  var isOurs = typeof label === 'string' && label.indexOf('(Ours)') !== -1;
                  c.save();
                  if (isGrouped) {
                    c.fillStyle = '#374151';
                    c.font = '11px "Avenir Next Cyr", "Inter", sans-serif';
                  } else {
                    c.fillStyle = isOurs ? '#6567C9' : '#374151';
                    c.font = (isOurs ? 'bold ' : '') + '12px "Avenir Next Cyr", "Inter", sans-serif';
                  }
                  c.textAlign = 'left';
                  c.textBaseline = 'middle';
                  c.fillText(value.toFixed(1), bar.x + 6, bar.y);
                  c.restore();
                });
              });
            }
          };

          function updateChart(benchmarkKey) {
            var data = benchmarkData[benchmarkKey];
            var chartContainer = ctx.parentElement;
            var greenBenchmarks = ['perceptiontest', 'nextqa', 'actnetqa', 'videomme', 'egoschema'];
            var orangeBenchmarks = ['tempcompass', 'tomato', 'cvrres', 'mvbench'];
            var purpleBenchmarks = ['videott', 'videommmu', 'lvbench', 'longvideobench'];
            if (greenBenchmarks.indexOf(benchmarkKey) !== -1) {
              chartContainer.style.backgroundColor = '#f0faf0';
            } else if (orangeBenchmarks.indexOf(benchmarkKey) !== -1) {
              chartContainer.style.backgroundColor = '#fff8f0';
            } else if (purpleBenchmarks.indexOf(benchmarkKey) !== -1) {
              chartContainer.style.backgroundColor = '#f5f0ff';
            } else {
              chartContainer.style.backgroundColor = 'transparent';
            }
            chartContainer.style.borderRadius = '12px';

            if (chart) chart.destroy();

            if (data.grouped) {
              /* ---- Grouped bar chart (VideoMME) ---- */
              chartContainer.style.height = '500px';
              var entries = Object.entries(data.models).sort(function(a, b) {
                return (a[1].wo || 0) - (b[1].wo || 0);
              });
              var labels = entries.map(function(e) { return e[0]; });
              var woValues = entries.map(function(e) { return e[1].wo; });
              var wValues  = entries.map(function(e) { return e[1].w; });
              var woColors = entries.map(function(e) { return e[0].indexOf('(Ours)') !== -1 ? '#b8b9e8' : '#CBD5E1'; });
              var wColors  = entries.map(function(e) { return e[0].indexOf('(Ours)') !== -1 ? '#6567C9' : '#94A3B8'; });
              var woBorders = entries.map(function(e) { return e[0].indexOf('(Ours)') !== -1 ? '#9b9dea' : '#A0AEC0'; });
              var wBorders  = entries.map(function(e) { return e[0].indexOf('(Ours)') !== -1 ? '#5254B3' : '#64748B'; });
              var allVals = woValues.concat(wValues).filter(function(v) { return v !== null; });
              var minVal = Math.floor(Math.min.apply(null, allVals) / 5) * 5;
              var maxVal = Math.ceil(Math.max.apply(null, allVals) / 5) * 5 + 5;

              chart = new Chart(ctx, {
                type: 'bar',
                data: {
                  labels: labels,
                  datasets: [
                    {
                      label: 'w/o subtitles',
                      data: woValues,
                      backgroundColor: woColors,
                      borderColor: woBorders,
                      borderWidth: 1,
                      borderRadius: 4,
                      barPercentage: 0.8,
                      categoryPercentage: 0.7
                    },
                    {
                      label: 'w/ subtitles',
                      data: wValues,
                      backgroundColor: wColors,
                      borderColor: wBorders,
                      borderWidth: 1,
                      borderRadius: 4,
                      barPercentage: 0.8,
                      categoryPercentage: 0.7
                    }
                  ]
                },
                options: {
                  indexAxis: 'y',
                  responsive: true,
                  maintainAspectRatio: false,
                  animation: { duration: 600, easing: 'easeOutQuart' },
                  layout: { padding: { left: 10, right: 40 } },
                  plugins: {
                    legend: { display: false },
                    title: {
                      display: true,
                      text: data.label,
                      font: { size: 16, weight: '600' },
                      padding: { bottom: 16 }
                    },
                    tooltip: {
                      backgroundColor: 'rgba(0,0,0,0.8)',
                      titleFont: { size: 13 },
                      bodyFont: { size: 13 },
                      padding: 10,
                      cornerRadius: 6,
                      callbacks: {
                        label: function(context) {
                          if (context.raw === null) return '';
                          return context.dataset.label + ': ' + context.raw.toFixed(1);
                        }
                      }
                    },
                    datalabels: false
                  },
                  scales: {
                    x: {
                      min: minVal,
                      max: maxVal,
                      grid: { color: 'rgba(0,0,0,0.06)' },
                      ticks: {
                        font: { size: 12 },
                        stepSize: 5,
                        callback: function(value) { return value.toFixed(0); }
                      },
                      title: {
                        display: true,
                        text: 'Accuracy',
                        font: { size: 13, weight: '500' }
                      }
                    },
                    y: {
                      grid: { display: false },
                      ticks: { color: 'transparent', font: { size: 12 } },
                      afterFit: function(axis) { axis.width = Math.max(axis.width, 200); }
                    }
                  }
                },
                plugins: [customYLabelsPlugin, valueLabelPlugin]
              });
            } else {
              /* ---- Standard single-bar chart ---- */
              chartContainer.style.height = '400px';
              var entries = Object.entries(data.models).sort(function(a, b) { return a[1] - b[1]; });
              var labels = entries.map(function(e) { return e[0]; });
              var values = entries.map(function(e) { return e[1]; });
              var bgColors = entries.map(function(e) { return getBarColor(e[0]); });
              var bdColors = entries.map(function(e) { return getBorderColor(e[0]); });
              var minVal = data.minX !== undefined ? data.minX : Math.floor(Math.min.apply(null, values) / 5) * 5;
              var maxVal = Math.ceil(Math.max.apply(null, values) / 5) * 5 + 5;

              chart = new Chart(ctx, {
                type: 'bar',
                data: {
                  labels: labels,
                  datasets: [{
                    data: values,
                    backgroundColor: bgColors,
                    borderColor: bdColors,
                    borderWidth: 1,
                    borderRadius: 4,
                    barThickness: 28
                  }]
                },
                options: {
                  indexAxis: 'y',
                  responsive: true,
                  maintainAspectRatio: false,
                  animation: { duration: 600, easing: 'easeOutQuart' },
                  layout: { padding: { left: 10, right: 40 } },
                  plugins: {
                    legend: { display: false },
                    title: {
                      display: true,
                      text: data.label,
                      font: { size: 16, weight: '600' },
                      padding: { bottom: 16 }
                    },
                    tooltip: {
                      backgroundColor: 'rgba(0,0,0,0.8)',
                      titleFont: { size: 13 },
                      bodyFont: { size: 13 },
                      padding: 10,
                      cornerRadius: 6,
                      callbacks: {
                        label: function(context) {
                          return 'Score: ' + context.raw.toFixed(1);
                        }
                      }
                    },
                    datalabels: false
                  },
                  scales: {
                    x: {
                      min: minVal,
                      max: maxVal,
                      grid: { color: 'rgba(0,0,0,0.06)' },
                      ticks: {
                        font: { size: 12 },
                        stepSize: 5,
                        callback: function(value) { return value.toFixed(0); }
                      },
                      title: {
                        display: true,
                        text: 'Accuracy',
                        font: { size: 13, weight: '500' }
                      }
                    },
                    y: {
                      grid: { display: false },
                      ticks: { color: 'transparent', font: { size: 12 } },
                      afterFit: function(axis) { axis.width = Math.max(axis.width, 200); }
                    }
                  }
                },
                plugins: [customYLabelsPlugin, valueLabelPlugin]
              });
            }
          }

          // Initialize with first benchmark
          updateChart('perceptiontest');

          // Button click handlers
          document.querySelectorAll('.benchmark-btn').forEach(function(btn) {
            btn.addEventListener('click', function() {
              document.querySelectorAll('.benchmark-btn').forEach(function(b) {
                b.classList.remove('is-active');
              });
              this.classList.add('is-active');
              updateChart(this.getAttribute('data-benchmark'));
            });
          });
        });
        </script>

        <!-- ==================== Runtime Comparison Script (inlined, no ES modules for file:// compat) ==================== -->
        <script>
        (function() {
          'use strict';

          /* ──── Config Data ──── */
          var videoCarousel = [
            {
              videoSrc: "runtime_comparison/assets/video_example1.mp4",
              caption: "Example Video",
              conversations: [
                { key:"q1", label:"Question 1",
                  phone1:{ question:"What is the score & time remaining in the first period of the hockey game?", answer:"The game is scoreless with 13:38 left on the clock." },
                  phone2:{ question:"What is the score & time remaining in the first period of the hockey game?", answer:"The score is tied at 0-0 with 13:38 remaining." }
                },
                { key:"q2", label:"Question 2",
                  phone1:{ question:"What happens to the player, number 52, during the game?", answer:"He's hurt and ends up falling on the ice several times throughout the game." },
                  phone2:{ question:"What happens to the player, number 52, during the game?", answer:"He is injured and falls to the ice multiple times during the game." }
                },
                { key:"q3", label:"Question 3",
                  phone1:{ question:"Who attends to the injured Toronto player, number 52?", answer:"A healthcare worker wearing a blue jacket." },
                  phone2:{ question:"Who attends to the injured Toronto player, number 52?", answer:"A medical staff member wearing a blue jacket." }
                },
                { key:"q4", label:"Question 4",
                  phone1:{ question:"Which player pushed player number 52?", answer:"Player 52 is being pushed by the player wearing the black-and-yellow jersey with number 46." },
                  phone2:{ question:"Which player pushed player number 52?", answer:"Player 52 was pushed by the player wearing the black-and-yellow jersey with number 46." }
                },
                { key:"q5", label:"Question 5",
                  phone1:{ question:"Which player is fighting with player number 51?", answer:"The player wearing number 51 (in the white-and-blue uniform) is engaged with a player wearing a dark jersey with yellow accents." },
                  phone2:{ question:"Which player is fighting with player number 51?", answer:"The player wearing a dark jersey with yellow accents is fighting with player number 51." }
                },
                { key:"q6", label:"Question 6",
                  phone1:{ question:"Which country broadcasts this program?", answer:'The logo says "Hockey Night in Canada", which is a well-known broadcast program from Canada.' },
                  phone2:{ question:"Which country broadcasts this program?", answer:"Based on the logo, this program is broadcasted in Canada." }
                }
              ],
              metrics: null /* No timing data available yet */
            },
            {
              videoSrc: "runtime_comparison/assets/video_example2.mp4",
              caption: "Example Video",
              conversations: [
                { key:"q1", label:"Question 1",
                  phone1:{ question:"What is the person preparing?", answer:"The person is preparing a sandwich." },
                  phone2:{ question:"What is the person preparing?", answer:"The person is preparing a sandwich." }
                },
                { key:"q2", label:"Question 2",
                  phone1:{ question:"What are the ingredients being used?", answer:"The ingredients include slices of bread, butter, cheese, and tomato." },
                  phone2:{ question:"What are the ingredients being used?", answer:"The ingredients are slices of white bread, butter, and slices of ham." }
                },
                { key:"q3", label:"Question 3",
                  phone1:{ question:"What is inside the cup?", answer:"The cup contains a tea bag." },
                  phone2:{ question:"What is inside the cup?", answer:"The cup contains a tea bag with dried herbs." }
                }
              ],
              metrics: {
                phone1: { /* LLaVA-Video */
                  questions: [
                    { ttft: 1.0003, e2el: 8.6354 },
                    { ttft: 0.0004, e2el: 0.4336 },
                    { ttft: 0.0004, e2el: 0.2367 }
                  ],
                  avgTtft: 0.3337,
                  avgE2el: 3.1019
                },
                phone2: { /* CoPE-VideoLM */
                  questions: [
                    { ttft: 0.3114, e2el: 0.7107 },
                    { ttft: 0.0004, e2el: 0.4151 },
                    { ttft: 0.0004, e2el: 0.2655 }
                  ],
                  avgTtft: 0.1041,
                  avgE2el: 0.4638
                }
              }
            }
          ];

          /* Fallback timing for videos without per-question metrics */
          var defaultDelays = { phone1: 2.39, phone2: 0.33 };
          var defaultMsPerToken = { phone1: 1390 / 64, phone2: 1330 / 64 };

          /* ──── State ──── */
          var rcState = { isPlaying: false, isPaused: false, timeouts: [], intervals: [] };
          var currentVideoIndex = 0;
          var conversationScript = videoCarousel[0].conversations;

          /* ──── Progress bar state ──── */
          var rcProgressInterval = null;
          var rcProgressStartTime = 0;
          var rcPhone1TotalDuration = 0;
          var rcPhone2TotalDuration = 0;
          var rcPhone1Done = false;
          var rcPhone2Done = false;

          /* ──── Metrics helpers ──── */
          function getMetrics() { return videoCarousel[currentVideoIndex].metrics; }

          function getQuestionMetrics(phoneKey, qIndex) {
            var m = getMetrics();
            if (m && m[phoneKey] && m[phoneKey].questions && m[phoneKey].questions[qIndex]) {
              return m[phoneKey].questions[qIndex];
            }
            return null;
          }

          function getTtftDelay(phoneKey, qIndex) {
            var qm = getQuestionMetrics(phoneKey, qIndex);
            if (qm) return qm.ttft;
            return defaultDelays[phoneKey] || 1;
          }

          function getTypingDuration(text, phoneKey, qIndex) {
            var qm = getQuestionMetrics(phoneKey, qIndex);
            if (qm) {
              /* Use actual E2EL - TTFT as total typing time */
              return Math.max((qm.e2el - qm.ttft) * 1000, 100);
            }
            /* Fallback: per-word based on default ms-per-token */
            var words = text.split(/( +)/);
            return words.length * (defaultMsPerToken[phoneKey] || 21);
          }

          function getTimingLabel(phoneKey, qIndex) {
            var m = getMetrics();
            if (!m) {
              var delay = defaultDelays[phoneKey] || 1;
              return 'Thought for ' + delay.toFixed(2) + 's';
            }
            var qm = getQuestionMetrics(phoneKey, qIndex);
            if (!qm) return '';
            if (qIndex === 0) {
              return 'TTFT: ' + qm.ttft.toFixed(2) + 's · E2EL: ' + qm.e2el.toFixed(2) + 's';
            }
            return 'E2EL: ' + qm.e2el.toFixed(2) + 's';
          }

          /* ──── Utility: tracked setTimeout ──── */
          function rcTrackedTimeout(cb, delay) {
            var id = setTimeout(cb, delay);
            rcState.timeouts.push(id);
            return id;
          }

          function rcClearAllTimers() {
            rcState.timeouts.forEach(function(id) { clearTimeout(id); });
            rcState.intervals.forEach(function(id) { clearInterval(id); });
            rcState.timeouts = [];
            rcState.intervals = [];
          }

          /* ──── UI helpers ──── */
          function rcCreateBubble(opts) {
            var type = opts.type, text = opts.text, side = opts.side;
            var row = document.createElement('div');
            row.className = 'rc-message-row ' + (side === 'right' ? 'right' : 'left');
            var bubble = document.createElement('div');
            bubble.classList.add('rc-bubble');
            bubble.dataset.type = type;

            if (type === 'question') {
              bubble.classList.add('rc-question');
              bubble.dataset.fullText = text;
              bubble.textContent = '';
              var readInd = document.createElement('div');
              readInd.className = 'rc-read-indicator';
              readInd.textContent = 'Read';
              bubble.appendChild(readInd);
            } else if (type === 'answer') {
              bubble.classList.add('rc-answer');
              bubble.dataset.fullText = text;
              bubble.textContent = '';
            } else if (type === 'read') {
              bubble.classList.add('rc-meta');
              var label = document.createElement('span');
              label.className = 'rc-meta-label';
              label.textContent = 'Thinking';
              bubble.appendChild(label);
              var typing = document.createElement('div');
              typing.className = 'rc-typing';
              for (var i = 0; i < 3; i++) {
                var dot = document.createElement('span');
                dot.className = 'rc-typing-dot';
                typing.appendChild(dot);
              }
              bubble.appendChild(typing);
            } else if (type === 'thought-time') {
              bubble.classList.add('rc-thought-time');
              bubble.textContent = text;
            }
            row.appendChild(bubble);
            return row;
          }

          function rcScrollToBottom(chatWindow) {
            requestAnimationFrame(function() {
              requestAnimationFrame(function() {
                chatWindow.scrollTop = chatWindow.scrollHeight;
              });
            });
          }

          /* Typewriter effect — types word-by-word over totalDurationMs */
          function rcTypewriterEffect(element, text, chatWindow, totalDurationMs) {
            var words = text.split(/( +)/);
            var wordIndex = 0;
            var perWordDelay = Math.max(totalDurationMs / words.length, 10);
            element.textContent = '';
            var intervalId = setInterval(function() {
              if (wordIndex < words.length) {
                element.textContent += words[wordIndex];
                wordIndex++;
                rcScrollToBottom(chatWindow);
              } else {
                clearInterval(intervalId);
              }
            }, perWordDelay);
            rcState.intervals.push(intervalId);
            return words.length * perWordDelay;
          }

          function rcResetChatWindows() {
            document.querySelectorAll('[data-role="rc-chat-window"]').forEach(function(cw) { cw.innerHTML = ''; });
            document.getElementById('rc-phone-1').classList.remove('is-orange');
          }

          function rcUpdateTime() {
            var now = new Date();
            var h = now.getHours();
            var m = now.getMinutes();
            var formatted = h + ':' + (m < 10 ? '0' : '') + m;
            document.querySelectorAll('#runtime-comparison .rc-status-right span:first-child').forEach(function(el) {
              el.textContent = formatted;
            });
          }

          function rcUpdateControlButtons() {
            var startBtn = document.getElementById('rcStartBtn');
            var pauseBtn = document.getElementById('rcPauseBtn');
            var resetBtn = document.getElementById('rcResetBtn');
            if (rcState.isPlaying) {
              startBtn.textContent = '\u25B6 Playing...';
              startBtn.disabled = true;
              pauseBtn.disabled = false;
              resetBtn.disabled = false;
            } else if (rcState.isPaused) {
              startBtn.textContent = '\u25B6 Resume';
              startBtn.disabled = false;
              pauseBtn.disabled = true;
              resetBtn.disabled = false;
            } else {
              startBtn.textContent = '\u25B6 Start';
              startBtn.disabled = false;
              pauseBtn.disabled = true;
              resetBtn.disabled = false;
            }
          }

          /* ──── Progress bars ──── */
          function rcInitProgressBars(dur1, dur2) {
            rcPhone1TotalDuration = dur1;
            rcPhone2TotalDuration = dur2;
            rcPhone1Done = false;
            rcPhone2Done = false;
            document.getElementById('rcProgressFill1').style.width = '0%';
            document.getElementById('rcProgressFill2').style.width = '0%';
            document.getElementById('rcProgressFill1').classList.remove('complete');
            document.getElementById('rcProgressFill2').classList.remove('complete');
            document.getElementById('rcProgressTime1').textContent = '0.00s';
            document.getElementById('rcProgressTime2').textContent = '0.00s';
            document.getElementById('rcProgressBadge1').textContent = '';
            document.getElementById('rcProgressBadge2').textContent = '';
            document.getElementById('rcProgressBadge1').className = 'rc-progress-badge';
            document.getElementById('rcProgressBadge2').className = 'rc-progress-badge';
            var speedup = document.getElementById('rcProgressSpeedup');
            speedup.textContent = '';
            speedup.classList.remove('visible');
            var summary = document.getElementById('rcProgressSummary');
            summary.innerHTML = '';
            summary.classList.remove('visible');
            var panel = document.getElementById('rcProgressPanel');
            panel.classList.remove('visible');
            void panel.offsetWidth;
            panel.classList.add('visible');
          }

          function rcStartProgressTicking() {
            rcProgressStartTime = performance.now();
            rcProgressInterval = setInterval(function() {
              var elapsed = performance.now() - rcProgressStartTime;
              if (!rcPhone1Done) {
                var pct1 = Math.min(elapsed / rcPhone1TotalDuration * 100, 100);
                document.getElementById('rcProgressFill1').style.width = pct1 + '%';
                document.getElementById('rcProgressTime1').textContent = (elapsed / 1000).toFixed(2) + 's';
                if (pct1 >= 100) {
                  rcPhone1Done = true;
                  document.getElementById('rcProgressTime1').textContent = (rcPhone1TotalDuration / 1000).toFixed(2) + 's';
                  document.getElementById('rcProgressFill1').classList.add('complete');
                }
              }
              if (!rcPhone2Done) {
                var pct2 = Math.min(elapsed / rcPhone2TotalDuration * 100, 100);
                document.getElementById('rcProgressFill2').style.width = pct2 + '%';
                document.getElementById('rcProgressTime2').textContent = (elapsed / 1000).toFixed(2) + 's';
                if (pct2 >= 100) {
                  rcPhone2Done = true;
                  document.getElementById('rcProgressTime2').textContent = (rcPhone2TotalDuration / 1000).toFixed(2) + 's';
                  document.getElementById('rcProgressFill2').classList.add('complete');
                }
              }
              if (rcPhone1Done && rcPhone2Done) {
                clearInterval(rcProgressInterval);
                rcProgressInterval = null;
                rcShowSpeedupBadges();
              }
            }, 50);
            rcState.intervals.push(rcProgressInterval);
          }

          function rcShowSpeedupBadges() {
            var badge1 = document.getElementById('rcProgressBadge1');
            var badge2 = document.getElementById('rcProgressBadge2');
            var speedup = document.getElementById('rcProgressSpeedup');
            if (rcPhone2TotalDuration < rcPhone1TotalDuration) {
              badge2.textContent = 'Faster';
              badge2.className = 'rc-progress-badge winner';
              badge1.textContent = 'Slower';
              badge1.className = 'rc-progress-badge slower';
              var ratio = (rcPhone1TotalDuration / rcPhone2TotalDuration).toFixed(1);
              speedup.textContent = '\u26A1 CoPE-VideoLM finished ' + ratio + '\u00D7 faster';
            } else if (rcPhone1TotalDuration < rcPhone2TotalDuration) {
              badge1.textContent = 'Faster';
              badge1.className = 'rc-progress-badge winner';
              badge2.textContent = 'Slower';
              badge2.className = 'rc-progress-badge slower';
              var ratio2 = (rcPhone2TotalDuration / rcPhone1TotalDuration).toFixed(1);
              speedup.textContent = '\u26A1 LLaVA-Video finished ' + ratio2 + '\u00D7 faster';
            } else {
              badge1.textContent = 'Tied';
              badge1.className = 'rc-progress-badge winner';
              badge2.textContent = 'Tied';
              badge2.className = 'rc-progress-badge winner';
              speedup.textContent = 'Both models finished at the same time';
            }
            speedup.classList.add('visible');

            /* Show avg TTFT / E2EL summary if metrics available */
            var m = getMetrics();
            if (m) {
              var summary = document.getElementById('rcProgressSummary');
              var html = '<div class="rc-summary-grid">';
              html += '<span></span>';
              html += '<span class="rc-summary-header rc-llava">LLaVA-Video</span>';
              html += '<span class="rc-summary-header rc-cope">CoPE-VideoLM</span>';
              html += '<span class="rc-summary-label">Avg TTFT</span>';
              html += '<span class="rc-summary-value rc-llava">' + m.phone1.avgTtft.toFixed(2) + 's</span>';
              html += '<span class="rc-summary-value rc-cope">' + m.phone2.avgTtft.toFixed(2) + 's</span>';
              html += '<span class="rc-summary-label">Avg E2EL</span>';
              html += '<span class="rc-summary-value rc-llava">' + m.phone1.avgE2el.toFixed(2) + 's</span>';
              html += '<span class="rc-summary-value rc-cope">' + m.phone2.avgE2el.toFixed(2) + 's</span>';
              html += '</div>';
              summary.innerHTML = html;
              /* Trigger reflow then animate in */
              void summary.offsetWidth;
              summary.classList.add('visible');
            }
          }

          function rcResetProgressBars() {
            if (rcProgressInterval) { clearInterval(rcProgressInterval); rcProgressInterval = null; }
            rcPhone1Done = false;
            rcPhone2Done = false;
            var panel = document.getElementById('rcProgressPanel');
            panel.classList.remove('visible');
          }

          /* ──── Animation ──── */
          function rcPlayQuestion(phoneId, qIndex, scriptEntry, startDelay) {
            var shell = document.getElementById(phoneId);
            var chatWindow = shell.querySelector('[data-role="rc-chat-window"]');
            var isPhone1 = phoneId === 'rc-phone-1';
            var phoneKey = isPhone1 ? 'phone1' : 'phone2';
            var content = isPhone1 ? scriptEntry.phone1 : scriptEntry.phone2;
            var ttft = getTtftDelay(phoneKey, qIndex);
            var typingMs = getTypingDuration(content.answer, phoneKey, qIndex);
            var timingLabel = getTimingLabel(phoneKey, qIndex);
            var thinkingDuration = Math.max(ttft * 1000, 200); /* min 200ms so dots are briefly visible */

            var doWork = function() {
              /* Show question bubble */
              var qBubble = rcCreateBubble({ type:'question', text:content.question, side:'right' });
              chatWindow.appendChild(qBubble);
              rcScrollToBottom(chatWindow);

              requestAnimationFrame(function() {
                var qEl = qBubble.querySelector('.rc-bubble');
                qEl.classList.add('visible');
                var ri = qEl.querySelector('.rc-read-indicator');
                if (ri) { qEl.insertBefore(document.createTextNode(content.question), ri); }
                else { qEl.textContent = content.question; }
                setTimeout(function() { if (ri) ri.classList.add('visible'); }, 450);
              });

              var readDelayMs = 650;

              rcTrackedTimeout(function() {
                /* Show thinking dots */
                var rBubble = rcCreateBubble({ type:'read', text:'', side:'left' });
                chatWindow.appendChild(rBubble);
                rcScrollToBottom(chatWindow);
                requestAnimationFrame(function() {
                  rBubble.querySelector('.rc-bubble').classList.add('visible');
                  var t = rBubble.querySelector('.rc-typing');
                  if (t) t.classList.add('active');
                });

                rcTrackedTimeout(function() {
                  rBubble.remove();

                  /* Show timing label (TTFT for Q1, E2EL for Q2+, or "Thought for" if no metrics) */
                  var tBubble = rcCreateBubble({ type:'thought-time', text: timingLabel, side:'left' });
                  chatWindow.appendChild(tBubble);
                  rcScrollToBottom(chatWindow);
                  requestAnimationFrame(function() { tBubble.querySelector('.rc-bubble').classList.add('visible'); });

                  /* Show answer with typewriter */
                  var aBubble = rcCreateBubble({ type:'answer', text:content.answer, side:'left' });
                  chatWindow.appendChild(aBubble);
                  rcScrollToBottom(chatWindow);
                  requestAnimationFrame(function() {
                    var aEl = aBubble.querySelector('.rc-bubble');
                    aEl.classList.add('visible');
                    rcTypewriterEffect(aEl, content.answer, chatWindow, typingMs);
                  });
                }, thinkingDuration);
              }, readDelayMs);
            };

            var totalTurnTime = 650 + thinkingDuration + typingMs + 300;

            if (startDelay > 0) {
              rcTrackedTimeout(doWork, startDelay);
            } else {
              doWork();
            }

            return totalTurnTime;
          }

          /* ──── Main animation ──── */
          function rcStartAnimation() {
            if (!conversationScript.length) return;
            rcState.isPlaying = true;
            rcState.isPaused = false;
            rcUpdateControlButtons();

            var phone1Total = 0;
            var phone2Total = 0;
            var p1Delay = 0;
            var p2Delay = 0;

            for (var i = 0; i < conversationScript.length; i++) {
              var entry = conversationScript[i];
              var p1Turn = rcPlayQuestion('rc-phone-1', i, entry, p1Delay);
              var p2Turn = rcPlayQuestion('rc-phone-2', i, entry, p2Delay);
              p1Delay += p1Turn + 1000;
              p2Delay += p2Turn + 1000;
            }

            phone1Total = p1Delay - 1000;
            phone2Total = p2Delay - 1000;

            rcInitProgressBars(phone1Total, phone2Total);
            rcStartProgressTicking();

            /* Mark phone1 orange after first question's TTFT */
            var firstTtft = getTtftDelay('phone1', 0);
            setTimeout(function() {
              document.getElementById('rc-phone-1').classList.add('is-orange');
            }, firstTtft * 1000 + 400);

            var totalDuration = Math.max(phone1Total, phone2Total);
            setTimeout(function() {
              rcState.isPlaying = false;
              rcUpdateControlButtons();
            }, totalDuration + 2000);
          }

          /* ──── Carousel ──── */
          function rcInitCarouselDots() {
            var dotsContainer = document.getElementById('rcCarouselDots');
            dotsContainer.innerHTML = '';
            videoCarousel.forEach(function(_, idx) {
              var dot = document.createElement('div');
              dot.className = 'rc-carousel-dot';
              if (idx === currentVideoIndex) dot.classList.add('active');
              dot.addEventListener('click', function() {
                if (rcState.isPlaying) return;
                currentVideoIndex = idx;
                conversationScript = videoCarousel[currentVideoIndex].conversations;
                rcUpdateCarouselUI();
                rcResetChatWindows();
                rcResetProgressBars();
              });
              dotsContainer.appendChild(dot);
            });
          }

          function rcUpdateCarouselUI() {
            var prevBtn = document.getElementById('rcPrevBtn');
            var nextBtn = document.getElementById('rcNextBtn');
            var indicator = document.getElementById('rcCarouselIndicator');
            var videoSource = document.getElementById('rcVideoSource');
            var heroVideo = document.getElementById('rcHeroVideo');
            var videoCaption = document.getElementById('rcVideoCaption');
            prevBtn.disabled = currentVideoIndex === 0;
            nextBtn.disabled = currentVideoIndex === videoCarousel.length - 1;
            indicator.textContent = (currentVideoIndex + 1) + ' / ' + videoCarousel.length;
            videoSource.src = videoCarousel[currentVideoIndex].videoSrc;
            heroVideo.load();
            videoCaption.textContent = videoCarousel[currentVideoIndex].caption;
            var dots = document.querySelectorAll('.rc-carousel-dot');
            dots.forEach(function(dot, idx) { dot.classList.toggle('active', idx === currentVideoIndex); });
          }

          function rcNavigateCarousel(direction) {
            if (rcState.isPlaying) return;
            var newIdx = currentVideoIndex + direction;
            if (newIdx >= 0 && newIdx < videoCarousel.length) {
              currentVideoIndex = newIdx;
              conversationScript = videoCarousel[currentVideoIndex].conversations;
              rcUpdateCarouselUI();
              rcResetChatWindows();
              rcResetProgressBars();
            }
          }

          /* ──── Init ──── */
          function rcInit() {
            rcInitCarouselDots();
            rcUpdateCarouselUI();
            rcUpdateTime();
            var timeInterval = setInterval(rcUpdateTime, 1000);
            rcState.intervals.push(timeInterval);

            document.getElementById('rcPrevBtn').addEventListener('click', function() { rcNavigateCarousel(-1); });
            document.getElementById('rcNextBtn').addEventListener('click', function() { rcNavigateCarousel(1); });

            document.getElementById('rcStartBtn').addEventListener('click', function() {
              if (!rcState.isPlaying) { rcResetChatWindows(); rcStartAnimation(); }
            });
            document.getElementById('rcPauseBtn').addEventListener('click', function() {
              if (rcState.isPlaying) {
                rcClearAllTimers();
                rcState.isPlaying = false;
                rcState.isPaused = true;
                rcUpdateControlButtons();
              }
            });
            document.getElementById('rcResetBtn').addEventListener('click', function() {
              rcClearAllTimers();
              rcResetChatWindows();
              rcResetProgressBars();
              rcState.isPlaying = false;
              rcState.isPaused = false;
              rcUpdateControlButtons();
            });
          }

          if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', rcInit);
          } else {
            rcInit();
          }
        })();
        </script>
    </body>
</html>
